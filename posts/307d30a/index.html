<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/pink/pace-theme-minimal.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"sidneygod.gitlab.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.12.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"stickytabs":true,"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><link rel="canonical" href="https://sidneygod.gitlab.io/posts/307d30a/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sidneygod.gitlab.io/posts/307d30a/","path":"posts/307d30a/","title":"[Make MyOS] Hello MyOS!"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>[Make MyOS] Hello MyOS! | Sidney God</title><script src="/lib/fireworks.js"></script><script>let titleTime,originTitile=document.title;document.addEventListener("visibilitychange",(function(){let i=document.querySelector('link[rel="icon"]');document.hidden?(i.setAttribute("href","/images/favicon.ico"),document.title="(つェ⊂) 我藏好了哦~"+originTitile,clearTimeout(titleTime)):(i.setAttribute("href","/images/favicon.ico"),document.title="(*´∇｀*) 被你发现啦~"+originTitile,titleTime=setTimeout((function(){document.title=originTitile}),2e3))}))</script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Sidney God" type="application/atom+xml">
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Sidney God</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Keep quiet time for time</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">19</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">7</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">26</span></a></li><li class="menu-item menu-item-resources"><a href="/resources/" rel="section"><i class="fa fa-book fa-fw"></i>Resources</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Catalogue</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-qemu"><span class="nav-text">1 qemu</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-nasm"><span class="nav-text">2 nasm</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-hex-editor"><span class="nav-text">3 hex editor</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-helloos0"><span class="nav-text">4 helloos0</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-helloos1"><span class="nav-text">5 helloos1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-helloos2"><span class="nav-text">6 helloos2</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Sidney Ding" src="/images/avatar.png"><p class="site-author-name" itemprop="name">Sidney Ding</p><div class="site-description" itemprop="description">You laugh at me for being different, but I laugh at you for being the same.</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">26</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">19</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/SidneyGod" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;SidneyGod" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:sidneyding183@gmail.com" title="E-Mail → mailto:sidneyding183@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://google.com/" title="https:&#x2F;&#x2F;google.com" rel="noopener" target="_blank">Google</a></li><li class="links-of-blogroll-item"><a href="https://bing.com/" title="https:&#x2F;&#x2F;bing.com" rel="noopener" target="_blank">Bing</a></li></ul></div></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/SidneyGod" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://sidneygod.gitlab.io/posts/307d30a/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="Sidney Ding"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sidney God"><meta itemprop="description" content="You laugh at me for being different, but I laugh at you for being the same."></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="[Make MyOS] Hello MyOS! | Sidney God"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">[Make MyOS] Hello MyOS!</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-08-21 21:20:47" itemprop="dateCreated datePublished" datetime="2021-08-21T21:20:47+08:00">2021-08-21</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2022-07-03 17:09:39" itemprop="dateModified" datetime="2022-07-03T17:09:39+08:00">2022-07-03</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a> </span>, <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/OS/Make-OS/" itemprop="url" rel="index"><span itemprop="name">Make OS</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Changyan: </span><a title="[Make MyOS] Hello MyOS!" href="/posts/307d30a/#SOHUCS" itemprop="discussionUrl"><span id="sourceId::a25aea6ac3ff3361328941e2949c3697" class="cy_cmt_count" itemprop="commentCount"></span> </a></span><span class="post-meta-break"></span> <span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span>5.7k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span>5 mins.</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>这是30天的第一天内容，也不知道自己能坚持到几天，有几天就几天了，活这么久了，半途而废的事情还少吗？</p><p>首先需要准备几个工具</p><h1 id="1-qemu"><a href="#1-qemu" class="headerlink" title="1 qemu"></a>1 qemu</h1><p>不可能真去买个软盘什么的，所以我们需要一个虚拟计算机的东西——QEMU</p><span id="more"></span><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># qemu编译可能要用到的东西</span></span><br><span class="line">sudo apt-get install ninja-build pkg-config build-essential zlib1g-dev \</span><br><span class="line">  libglib2.0-dev binutils-dev libboost-all-dev autoconf libtool libssl-dev \</span><br><span class="line">  libpixman-1-dev libpython-dev python-pip python-capstone virtualenv</span><br><span class="line"><span class="comment"># qemu显示要的东西 没有这个只能通过VNC去看了</span></span><br><span class="line">sudo apt install libsdl2-dev -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载qemu源码 其实安装qemu倒没必要这么麻烦 只是我想着可能会顺带研究一下qemu</span></span><br><span class="line">wget https://download.qemu.org/qemu-6.1.0-rc3.tar.xz</span><br><span class="line">tar xvJf qemu-6.1.0-rc3.tar.xz</span><br><span class="line"><span class="built_in">cd</span> qemu-6.1.0-rc3</span><br><span class="line">./configure  <span class="comment"># 默认安装路径是/usr/local/bin/，这里注意 SDL support: YES 不为YES 后面就只能通过VNC查看了</span></span><br><span class="line">make -j4</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><p>遇到的问题，当安装apt遇到下列错误时</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E: Could <span class="keyword">not</span> <span class="keyword">get</span> <span class="keyword">lock</span> /var/lib/dpkg/<span class="keyword">lock</span>-frontend - <span class="keyword">open</span> (<span class="number">11</span>: Resource temporarily unavailable)</span><br><span class="line">E: Unable <span class="keyword">to</span> acquire the dpkg frontend <span class="keyword">lock</span> (/var/lib/dpkg/<span class="keyword">lock</span>-frontend), <span class="keyword">is</span> another process <span class="keyword">using</span> it?</span><br></pre></td></tr></table></figure><p>建议直接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /var/lib/apt/lists/lock</span><br><span class="line">sudo <span class="built_in">rm</span> /var/cache/apt/archives/lock</span><br><span class="line">sudo <span class="built_in">rm</span> /var/lib/dpkg/lock*</span><br><span class="line">sudo dpkg --configure -a</span><br><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><h1 id="2-nasm"><a href="#2-nasm" class="headerlink" title="2 nasm"></a>2 nasm</h1><p>写操作系统嘛，总不可能真的就用01来干，那得累死，所以需要用汇编，书中用的是nask，nask和nasm同为汇编编译器。nasm支持win、linux和MacOS，mask仅支持win。这两个差别不大，由于我们是在Ubuntu18下进行试验，所以必然选择nasm了，差距就是</p><table><thead><tr><th>nask代码</th><th>nasm代码</th></tr></thead><tbody><tr><td><code>JMP entry</code></td><td><code>JMP SHORT entry</code></td></tr><tr><td><code>RESB &lt;填充字节数&gt;</code></td><td><code>TIMES &lt;填充字节数&gt; DB &lt;填充数据&gt;</code></td></tr><tr><td><code>RESB 0x7dfe-$</code></td><td><code>TIMES 0x1fe-($-$) DB 0</code></td></tr><tr><td><code>ALIGNB 16</code></td><td><code>ALIGN 16, DB 0</code></td></tr></tbody></table><p>我觉得这个就没必要再通过二进制包安装了，直接<code>sudo apt install nasm</code>就好了，然后用<code>nasm --version</code>检测一下是否安装好就ok了</p><h1 id="3-hex-editor"><a href="#3-hex-editor" class="headerlink" title="3 hex editor"></a>3 hex editor</h1><p>不说用01去写代码吧，看看01代码还是有必要的，所以还是需要一个趁手的十六进制编辑器的，这玩意我就随意百度了俩</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install wxhexeditor <span class="comment"># 这玩意好久没更新了 官网都没了 但是挺好用的</span></span><br><span class="line">sudo apt-get install bless       <span class="comment"># 这个倒在更新 但是感觉一般吧</span></span><br><span class="line">sudo apt-get install hexedit     <span class="comment"># 这个是命令行版本</span></span><br></pre></td></tr></table></figure><p>我觉得还是wxHexEditor比较强大，因为16进制能转成汇编..</p><h1 id="4-helloos0"><a href="#4-helloos0" class="headerlink" title="4 helloos0"></a>4 helloos0</h1><p>这个时候可以尝试实验了，直接把光盘中的<code>projects/01_day/helloos0/helloos.img</code>拷到我们自己的目录下，然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sidney@ubuntu:~/Work/MyOS/day01$ qemu-system-i386 helloos.img</span><br><span class="line">WARNING: Image format was not specified <span class="keyword">for</span> <span class="string">'helloos.img'</span> and probing guessed raw.</span><br><span class="line">         Automatically detecting the format is dangerous <span class="keyword">for</span> raw images, write operations on block 0 will be restricted.</span><br><span class="line">         Specify the <span class="string">'raw'</span> format explicitly to remove the restrictions.</span><br></pre></td></tr></table></figure><p>虽然有warning，但是至少系统跑起来了，而想让这段警告消失，也很简单，将命令改为<code>qemu-system-i386 -drive file=helloos.img,format=raw,if=floppy</code>就ok了</p><p>按照书上说的，使用十六进制编写OS，神经病..我才不抄，浪费时间</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">0000000:</span> <span class="string">EB4E</span> <span class="number">9048 </span><span class="string">454C</span> <span class="string">4C4F</span> <span class="number">4950 </span><span class="string">4C00</span> <span class="number">0201 </span><span class="number">0100</span> </span><br><span class="line"><span class="attr">0000016:</span> <span class="number">02E0</span> <span class="number">0040 </span><span class="string">0BF0</span> <span class="number">0900 </span><span class="number">1200 </span><span class="number">0200 </span><span class="number">0000 </span><span class="number">0000</span> </span><br><span class="line"><span class="attr">0000032:</span> <span class="string">400B</span> <span class="number">0000 </span><span class="number">0000 </span><span class="string">29FF</span> <span class="string">FFFF</span> <span class="string">FF48</span> <span class="string">454C</span> <span class="string">4C4F</span> </span><br><span class="line"><span class="attr">0000048:</span> <span class="string">2D4F</span> <span class="number">5320 </span><span class="number">2020 </span><span class="number">4641 </span><span class="number">5431 </span><span class="number">3220 </span><span class="number">2020 </span><span class="number">0000</span> </span><br><span class="line"><span class="attr">0000064:</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span> </span><br><span class="line"><span class="attr">0000080:</span> <span class="string">B800</span> <span class="string">008E</span> <span class="string">D0BC</span> <span class="string">007C</span> <span class="string">8ED8</span> <span class="string">8EC0</span> <span class="string">BE74</span> <span class="string">7C8A</span> </span><br><span class="line"><span class="attr">0000096:</span> <span class="number">0483 </span><span class="string">C601</span> <span class="string">3C00</span> <span class="number">7409 </span><span class="string">B40E</span> <span class="string">BB0F</span> <span class="string">00CD</span> <span class="string">10EB</span> </span><br><span class="line"><span class="attr">0000112:</span> <span class="string">EEF4</span> <span class="string">EBFD</span> <span class="string">0A0A</span> <span class="number">6865 </span><span class="string">6C6C</span> <span class="string">6F2C</span> <span class="number">2077 </span><span class="string">6F72</span> </span><br><span class="line"><span class="attr">0000128:</span> <span class="string">6C64</span> <span class="string">0A00</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span> </span><br><span class="line"><span class="string">.......:</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"><span class="attr">0000496:</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="string">55AA</span></span><br><span class="line"><span class="attr">0000512:</span> <span class="string">F0FF</span> <span class="string">FF00</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"><span class="string">.......:</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"><span class="attr">0005120:</span> <span class="string">F0FF</span> <span class="string">FF00</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"><span class="string">.......:</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"><span class="attr">1474544:</span> <span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"><span class="attr">1474560:</span> <span class="comment"># 因为我们是从0开始计数的哦</span></span><br></pre></td></tr></table></figure><p>剩下的内容全为0，文件大小为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="28.283ex" height="1.717ex" role="img" focusable="false" viewBox="0 -677 12500.9 759"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g><g data-mml-node="mo" transform="translate(1222.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mn" transform="translate(2222.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z" transform="translate(500,0)"></path></g><g data-mml-node="mo" transform="translate(3444.7,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mn" transform="translate(4444.9,0)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(500,0)"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(1000,0)"></path></g><g data-mml-node="mo" transform="translate(6167.1,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mn" transform="translate(7167.3,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mo" transform="translate(7945.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(9000.9,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(500,0)"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(1000,0)"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(1500,0)"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(2000,0)"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(2500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(3000,0)"></path></g></g></g></svg></mjx-container>字节，这个很重要，一定要保证大小正确</p><h1 id="5-helloos1"><a href="#5-helloos1" class="headerlink" title="5 helloos1"></a>5 helloos1</h1><p>按照书上第二步，稍微高级一点的东西，涉及到汇编，直接<code>vim myos.asm</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">DB  0xeb, 0x4e, 0x90, 0x48, 0x45, 0x4c, 0x4c, 0x4f</span><br><span class="line">DB  0x49, 0x50, 0x4c, 0x00, 0x02, 0x01, 0x01, 0x00</span><br><span class="line">DB  0x02, 0xe0, 0x00, 0x40, 0x0b, 0xf0, 0x09, 0x00</span><br><span class="line">DB  0x12, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00</span><br><span class="line">DB  0x40, 0x0b, 0x00, 0x00, 0x00, 0x00, 0x29, 0xff</span><br><span class="line">DB  0xff, 0xff, 0xff, 0x48, 0x45, 0x4c, 0x4c, 0x4f</span><br><span class="line">DB  0x2d, 0x4f, 0x53, 0x20, 0x20, 0x20, 0x46, 0x41</span><br><span class="line">DB  0x54, 0x31, 0x32, 0x20, 0x20, 0x20, 0x00, 0x00</span><br><span class="line">; RESB 16  ;这里和书上不一样 因为我们的环境是nasm而不是nask</span><br><span class="line">TIMES 16 DB 0x00</span><br><span class="line">DB  0xb8, 0x00, 0x00, 0x8e, 0xd0, 0xbc, 0x00, 0x7c</span><br><span class="line">DB  0x8e, 0xd8, 0x8e, 0xc0, 0xbe, 0x74, 0x7c, 0x8a</span><br><span class="line">DB  0x04, 0x83, 0xc6, 0x01, 0x3c, 0x00, 0x74, 0x09</span><br><span class="line">DB  0xb4, 0x0e, 0xbb, 0x0f, 0x00, 0xcd, 0x10, 0xeb</span><br><span class="line">DB  0xee, 0xf4, 0xeb, 0xfd, 0x0a, 0x0a, 0x68, 0x65</span><br><span class="line">DB  0x6c, 0x6c, 0x6f, 0x2c, 0x20, 0x77, 0x6f, 0x72</span><br><span class="line">DB  0x6c, 0x64, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00</span><br><span class="line">; RESB    368</span><br><span class="line">TIMES  368 DB 0x00</span><br><span class="line">DB	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0xaa</span><br><span class="line">DB	0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00</span><br><span class="line">; RESB  4600</span><br><span class="line">TIMES  4600 DB 0x00</span><br><span class="line">DB  0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00</span><br><span class="line">; RESB  1469432</span><br><span class="line">TIMES  1469432 DB 0x00</span><br></pre></td></tr></table></figure><p>通过命令<code>nasm myos.asm -o myos.img</code>得到我们编译出的操作系统，依旧是执行<code>qemu-system-i386 -drive file=myos.img,format=raw,if=floppy</code>，运行我们的操作系统，出现个hello world。不过这玩意还是不大能看懂什么意思</p><h1 id="6-helloos2"><a href="#6-helloos2" class="headerlink" title="6 helloos2"></a>6 helloos2</h1><p>再按书中的汇编，写个能看懂的操作系统</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">; hello-os</span><br><span class="line">; TAB=4</span><br><span class="line"></span><br><span class="line">; 以下这段是标准FAT12格式软盘专用代码</span><br><span class="line">DB  0xeb, 0x4e, 0x90 ; 这里eb4e是jmp 0x00000050，而90是nop</span><br><span class="line">DB  "HELLOIPL"       ; 启动区的名称 可以是任意的字符串(8字节)</span><br><span class="line">DW  512              ; 每个扇区(sector)的大小(必须是512字节)</span><br><span class="line">DB  1                ; 簇(cluster)的大小(必须为1个扇区)</span><br><span class="line">DW  1                ; FAT的起始位置(一般从第一个扇区开始)</span><br><span class="line">DB  2                ; FAT的个数(必须为2)</span><br><span class="line">DW  224              ; 根目录的大小(一般设置为224项)</span><br><span class="line">DW  2880             ; 该磁盘的大小(必须是2880扇区)</span><br><span class="line">DB  0xf0             ; 磁盘的种类(必须是0xf0)</span><br><span class="line">DW  9                ; FAT的长度(必须是9扇区)</span><br><span class="line">DW  18               ; 1个磁道(track)有几个扇区(必须是18)</span><br><span class="line">DW  2                ; 磁头数(必须是2)</span><br><span class="line">DD  0                ; 不使用分区(必须是0)</span><br><span class="line">DD  2880             ; 重写一次磁盘大小</span><br><span class="line">DB  0,0,0x29         ; 意义不明 固定</span><br><span class="line">DD  0xffffffff       ; (可能是)卷标号码</span><br><span class="line">DB  "HELLO-OS   "    ; 磁盘的名称(11字节)</span><br><span class="line">DB  "FAT12   "       ; 磁盘格式名称(8字节)</span><br><span class="line">;RESB  18             ; 先空出18字节</span><br><span class="line">TIMES  18  DB 0</span><br><span class="line"></span><br><span class="line">; 程序主体</span><br><span class="line">DB  0xb8, 0x00, 0x00, 0x8e, 0xd0, 0xbc, 0x00, 0x7c</span><br><span class="line">DB  0x8e, 0xd8, 0x8e, 0xc0, 0xbe, 0x74, 0x7c, 0x8a</span><br><span class="line">DB  0x04, 0x83, 0xc6, 0x01, 0x3c, 0x00, 0x74, 0x09</span><br><span class="line">DB  0xb4, 0x0e, 0xbb, 0x0f, 0x00, 0xcd, 0x10, 0xeb</span><br><span class="line">DB  0xee, 0xf4, 0xeb, 0xfd</span><br><span class="line"></span><br><span class="line">; 信息显示部分</span><br><span class="line">DB  0x0a, 0x0a       ; 两个换行</span><br><span class="line">DB  "This is my first OS!"</span><br><span class="line">DB  0x0a             ; 换行</span><br><span class="line">DB  0</span><br><span class="line">;RESB  0x1fe-$       ; 填写0x00，直到0x001fe</span><br><span class="line">TIMES  0x1fe-($-$)  DB 0</span><br><span class="line">DB  0x55, 0xaa       ; 必须保证510字节处是55aa</span><br><span class="line"></span><br><span class="line">; 以下是启动区以外部分的输出</span><br><span class="line">DB  0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00</span><br><span class="line">;RESB  4600</span><br><span class="line">TIMES   4600  DB  0</span><br><span class="line">DB  0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00</span><br><span class="line">;RESB  1469432</span><br><span class="line">TIMES  1469432  DB  0</span><br></pre></td></tr></table></figure><p>DB: define byte，往文件里直接写入1字节的指令</p><p>DW: define word，16位</p><p>DD: define double-word，32位</p><p>$ : 代表一个变量，表示当前行的偏移地址</p><p>$$: 代表一个变量，表示当前段(汇编的section，数据段，代码段..)的起始偏移地址</p><p>TIMES: 重复定义数据或指令</p><p>RESB：reserve byte的缩写，RESB 10这一指令的含义是：从现在的地址开始空出10个字节，且nask（编译器）会自动在空出的部分填充上0x00，这就极大的节省了输入大量0x00的时间。</p><p>启动区(boot sector): 软盘第一个扇区称为启动区。计算机读写软盘时，是以512字节为一个单位进行读写的，因此软盘的512字节就称为一个扇区。一张软盘共有1440KB，也就是1474560字节，除以512得2880，也就是一张软盘有2880个扇区。计算机从最初一个扇区开始读软盘，然后去检查这个扇区最后2个字节的内容。如果最后2个字节不是55AA，计算机就认为这张盘上没有所需要启动的程序，就会报一个不能启动的错误。如果是55AA，那它就认为这个扇区的开头是启动程序，并开始执行这个程序。55AA没啥特殊含义..人家发明的时候定的</p><p>IPL(initial program loader): 启动程序加载器。启动区只有512字节，正常的操作系统不可能这么小，所以几乎所有的操作系统都是把加载操作系统本身的程序放在启动区里的。启动区的名字必须是8字节，不够得用空格补</p><p>感觉有上一篇的操作系统启动流程扫盲，有很多知识点还是比较清晰的..但是还是有几个疑惑点没去尝试，软盘能改成hdd？FAT12给整成FAT32？</p></div><footer class="post-footer"><div class="readEnd">------- This article is over <i class="fa fa-leaf" aria-hidden="true"></i> Thank you for your reading -------</div><div class="reward-container"><div>All I need is you needing me.</div><button>Donate</button><div class="post-reward"><div><img src="/images/wechatpay.png" alt="Sidney Ding WeChat Pay"> <span>WeChat Pay</span></div><div><img src="/images/alipay.jpg" alt="Sidney Ding Alipay"> <span>Alipay</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>Post author: </strong>Sidney Ding</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://sidneygod.gitlab.io/posts/307d30a/" title="[Make MyOS] Hello MyOS!">https://sidneygod.gitlab.io/posts/307d30a/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/32699cc/" rel="prev" title="[Make MyOS] After power on"><i class="fa fa-chevron-left"></i> [Make MyOS] After power on</a></div><div class="post-nav-item"><a href="/posts/c0d78c8f/" rel="next" title="[Make MyOS] Make a boot">[Make MyOS] Make a boot <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="SOHUCS" sid="a25aea6ac3ff3361328941e2949c3697"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sidney Ding</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span>Symbols count total: </span><span title="Symbols count total">298k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span>Reading time total &asymp;</span> <span title="Reading time total">4:31</span></span></div><div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a></div><div><span><i class="fa-solid fa-bomb"></i> </span><span id="showDays"></span></div><script>let seconds=1e3,minutes=60*seconds,hours=60*minutes,days=24*hours,years=365*days,birthDay=Date.UTC(2019,10,1,0,0,0);setInterval((function(){let e=new Date,s=e.getFullYear(),t=e.getMonth()+1,o=e.getDate(),a=e.getHours(),n=e.getMinutes(),r=e.getSeconds(),h=Date.UTC(s,t,o,a,n,r)-birthDay,u=Math.floor(h/years),d=Math.floor(h/days-365*u),y=Math.floor((h-(365*u+d)*days)/hours),i=Math.floor((h-(365*u+d)*days-y*hours)/minutes),l=Math.floor((h-(365*u+d)*days-y*hours-i*minutes)/seconds);document.getElementById("showDays").innerHTML="This website has been running for "+u+" years, "+d+" days, "+y+" hours, "+i+" minutes, "+l+" seconds"}),1e3)</script></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer"}</script><script src="/js/third-party/tags/pdf.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"neutral","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.1/mermaid.min.js","integrity":"sha256-8L3O8tirFUa8Va4NSTAyIbHJeLd6OnlcxgupV9F77e0="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.1/es5/tex-mml-chtml.js","integrity":"sha256-hlC2uSQYTmPsrzGZTEQEg9PZ1a/+SV6VBCTclohf2og="}}</script><script src="/js/third-party/math/mathjax.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.2.0/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":false,"archive":false,"delay":true,"timeout":3000,"priority":true,"url":"https://sidneygod.gitlab.io/posts/307d30a/"}</script><script src="/js/third-party/quicklink.js"></script><script src="/js/love.js"></script><script src="/js/show-text.js"></script><script src="/js/snowflakes.min.js"></script><script src="/js/activate-power-mode.min.js"></script><script>new Snowflakes({color:"rgba(129, 161, 193, 0.87)"}),POWERMODE.colorful=!0,POWERMODE.shake=!0,document.body.addEventListener("input",POWERMODE)</script><script class="next-config" data-name="changyan" type="application/json">{"enable":true,"appid":"cyw6GhFAo","appkey":"39c16599e32c872d8661763f6b93d932"}</script><script src="/js/third-party/comments/changyan.js"></script></body></html>